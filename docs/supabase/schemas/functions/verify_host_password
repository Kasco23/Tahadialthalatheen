
DECLARE
  stored_password text;
BEGIN
  -- Get the stored hashed password for the session
  SELECT host_password INTO stored_password
  FROM public."Session"
  WHERE session_code = session_code_input;
  
  -- If session not found, return false
  IF stored_password IS NULL THEN
    RETURN FALSE;
  END IF;
  
  -- Verify the password using crypt function
  RETURN crypt(password_input, stored_password) = stored_password;
END;
